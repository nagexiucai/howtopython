<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name='keywords' content='那个秀才 SCH.PY'/>
    <meta name='description' content='小车游戏带小白体验编程的乐趣'/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>SCH.PY CarGame</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        html, body, table, thead, tbody, tfoot, tr, th, td {
            margin: 0;
            padding: 0;
            text-align: center;
        }
        caption {
            background-color: aqua;
        }
        .hcenter {
            margin-left: auto;
            margin-right: auto;
        }
        th {
            height: 0px;
        }
        td {
            border: 1px solid;
            height: 22px;
        }
        label, input {
            display: block;
        }
        .here {
            background-color: salmon;
        }
        .goal {
            background-color: blue;
        }
        .pass {
            background-color: green;
        }
        .hole {
            background-color: black;
        }
        .code {
            width: 30%;
            min-height: 11em;
        }
        .instruction {
            width: 30%;
        }
        .title {
            background-color: gold;
        }
    </style>
    <script>
        var cmd = undefined;
        var code = undefined;
        var h = undefined;
        var v = undefined;
        var cells = undefined;
        var __holes = [{h:2,v:2},{h:3,v:7},{h:6,v:4}];
        function Initialize() {
            cmd = document.getElementById("cmd");
            code = document.getElementById("code");
            h = 0;
            v = 0;
            cells = [];
            var stage = document.getElementById("stage");
            var trs = stage.getElementsByTagName("tr");
            for (var i=0; i<trs.length; i++) {
                var tds = trs[i].getElementsByTagName("td");
                for (var j=0; j<tds.length; j++) {
                    if (i == 0 && j == 9) {
                        tds[j].className = "goal";
                    }
                    else if (i == 9 && j == 0) {
                        tds[j].className = "here";
                    }
                    else {
                        tds[j].className = "";
                    }
                }
                cells.push(tds);
            }
            cells.reverse();
            for (var k=0; k<__holes.length; k++) {
                cells[__holes[k].v][__holes[k].h].className = "hole";
            }
        }
        function Command() {
            var x = h;
            var y = v;
            if (cmd.value == "LEFT") {x -= 1;}
            else if (cmd.value == "RIGHT") {x += 1;}
            else if (cmd.value == "UP") {y += 1;}
            else if (cmd.value == "DOWN") {y -= 1;}
            else {
                alert("请下达可识别的命令！");
                return false;
            }
            if (x < 0) {alert("已经到最左边！");return false;}
            if (x > 9) {alert("已经到最右边！");return false;}
            if (y < 0) {alert("已经到最下边！");return false;}
            if (y > 9) {alert("已经到最上边！");return false;}
            for (var i=0; i<__holes.length; i++) {
                if (x == __holes[i].h && y == __holes[i].v) {
                    alert("悬崖勒马、回头是岸！");
                    return false;
                }
            }
            cells[v][h].className = "pass";
            cells[y][x].className = "here";
            h = x;
            v = y;
            return true;
        }
        function Script() {
            var instructions = code.value.split("\n");
            for (var i=0; i<instructions.length; i++) {
                var order = instructions[i].trim();
                cmd.value = order;
                if (!Command()) {
                    alert("第"+(i+1)+"步指令"+order+"非法!");
                    break;
                }
            }
            cmd.value = "";
        }
    </script>
</head>
<body onload="Initialize();">
    <div>
        <table class="hcenter" width="35%">
            <caption>小车游戏<br/>让小车从【左下角】行驶到【右上角】</caption>
            <tr class="title"><td>指令</td><td>含义</td></tr>
            <tr><td class="instruction">LEFT</td><td>向左移动一个单元格子</td></tr>
            <tr><td class="instruction">RIGHT</td><td>向右移动一个单元格子</td></tr>
            <tr><td class="instruction">UP</td><td>向上移动一个单元格子</td></tr>
            <tr><td class="instruction">DOWN</td><td>向下移动一个单元格子</td></tr>
            <tr class="title"><td>颜色</td><td>含义</td></tr>
            <tr><td class="here"></td><td>当前位置</td></tr>
            <tr><td class="goal"></td><td>目标位置</td></tr>
            <tr><td class="pass"></td><td>走过的路</td></tr>
            <tr><td class="hole"></td><td>无底黑洞</td></tr>
        </table>
        <hr/>
        <table class="hcenter" width="45%">
            <caption>走出不一样的路</caption>
            <thead>
                <tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr>
            </thead>
            <tbody id="stage">
                <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td class="goal"></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td class="here"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            </tbody>
            <tfoot></tfoot>
        </table>
        <input class="hcenter" type="button" value="复位" onclick="Initialize();">
    </div>
    <div>
        <hr/>
        <label>请下命令</label>
        <input id="cmd" class="hcenter" type="text">
        <input class="hcenter" type="button" value="执行命令" onclick="Command();">
        <hr/>
        <label>编辑脚本</label>
        <textarea id="code" class="code hcenter"></textarea>
        <input class="hcenter" type="button" value="执行脚本" onclick="Script();">
    </div>
</body>
</html>